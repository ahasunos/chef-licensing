:file_format_version: 1.0.0

interactions:
  start:
    messages: |
      -----------------------------------------------------
                   Provide Your License ID

        To access premium content and other special features,
        you will need a Chef License ID.

        If you already have one, you can enter it at the prompt
        on the following screen.

        If you need to get an evaluation or personal use license
        ID, you can get one by providing your details.
      -------------------------------------------------------
    prompt_type: "say"
    paths: [ask_if_user_has_license_id]

  ask_if_user_has_license_id:
    messages: "Do you have a Chef License ID?"
    prompt_type: "timeout_yes"
    prompt_attributes:
      timeout_duration: 60
      timeout_message: "\nPrompt timed out. Use non-interactive flags or enter an answer within 60 seconds."
    paths: [ask_for_license_id, ask_for_license_generation]
    response_path_map:
      "true": ask_for_license_id
      "false": ask_for_license_generation

  ask_for_license_id:
    messages: "Please input your License ID: "
    prompt_type: "ask"
    paths: [validate_license_id_pattern]

  validate_license_id_pattern:
    action: is_license_with_valid_pattern?
    paths: [validate_license_id_with_api, ask_for_license_id]
    response_path_map:
      "true": validate_license_id_with_api
      "false": ask_for_license_id
    description: "is_license_with_valid_pattern? is a method defined in TUIActions class"

  ask_for_license_generation:
    messages: ["Would you like to generate a license id?"]
    prompt_type: "yes"
    paths: [display_type_of_license_id, exit]
    response_path_map:
      "true": display_type_of_license_id
      "false": exit
  
  display_type_of_license_id:
    messages: "This is yet to be implemented."
    paths: [exit]

  validate_license_id_with_api:
    action: is_license_valid_on_server?
    paths: [validation_success, validation_failure]
    response_path_map:
      "true": validation_success
      "false": validation_failure
    description: "is_license_valid_on_server? is a method defined in TUIActions class"

  validation_success:
    messages: "License validated successfully."
    paths: [exit]
  
  validation_failure:
    messages: "License is not valid. Please try again."
    paths: [ask_for_license_id]

  exit:
    messages: "Thank you."
